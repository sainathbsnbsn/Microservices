CREATE TABLE PROBLEMS (
    PROBLEM_ID          NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    TITLE               VARCHAR2(255) NOT NULL,
    SLUG                VARCHAR2(255) UNIQUE NOT NULL,
    DIFFICULTY          VARCHAR2(20) NOT NULL,
    DIFFICULTY_SCORE    NUMBER,
    PATTERNS            VARCHAR2(500),
    TOPICS              VARCHAR2(500),
    ASKED_IN            VARCHAR2(500),
    IS_PREMIUM          CHAR(1) CHECK (IS_PREMIUM IN ('Y', 'N')),
    STATUS              VARCHAR2(20),
    POPULARITY_SCORE    NUMBER,
    ATTEMPT_COUNT       NUMBER,
    SUCCESS_RATE        NUMBER(5,2),
    FREQUENCY_TAG       VARCHAR2(50),
    PROBLEM_STATEMENT   CLOB,
    CREATED_AT          TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UPDATED_AT          TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE PROBLEM_EXAMPLES (
    EXAMPLE_ID      NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    PROBLEM_ID      NUMBER NOT NULL,
    INPUT           CLOB,
    OUTPUT          CLOB,
    EXPLANATION     CLOB,

    CONSTRAINT FK_EXAMPLES_PROBLEM
        FOREIGN KEY (PROBLEM_ID)
        REFERENCES PROBLEMS(PROBLEM_ID)
        ON DELETE CASCADE
);

CREATE TABLE PROBLEM_CONSTRAINTS (
    CONSTRAINT_ID       NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    PROBLEM_ID          NUMBER NOT NULL,
    CONSTRAINT_TEXT     CLOB,

    CONSTRAINT FK_CONS_PROBLEM
        FOREIGN KEY (PROBLEM_ID)
        REFERENCES PROBLEMS(PROBLEM_ID)
        ON DELETE CASCADE
);

CREATE TABLE PROBLEM_HINTS (
    HINT_ID     NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    PROBLEM_ID  NUMBER NOT NULL,
    HINT_ORDER  NUMBER,
    HINT_TEXT   CLOB,

    CONSTRAINT FK_HINTS_PROBLEM
        FOREIGN KEY (PROBLEM_ID)
        REFERENCES PROBLEMS(PROBLEM_ID)
        ON DELETE CASCADE
);

CREATE TABLE PROBLEM_SOLUTIONS (
    SOLUTION_ID         NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    PROBLEM_ID          NUMBER NOT NULL,
    APPROACH_NAME       VARCHAR2(100),
    TAG                 VARCHAR2(50),      -- good, better, best
    TIME_COMPLEXITY     VARCHAR2(50),
    SPACE_COMPLEXITY    VARCHAR2(50),
    EXPLANATION         CLOB,

    CONSTRAINT FK_SOL_PROBLEM
        FOREIGN KEY (PROBLEM_ID)
        REFERENCES PROBLEMS(PROBLEM_ID)
        ON DELETE CASCADE
);


CREATE TABLE SOLUTION_CODE (
    CODE_ID        NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    SOLUTION_ID    NUMBER NOT NULL,
    LANGUAGE       VARCHAR2(50),     -- Java, Python, C++
    CODE_TEXT      CLOB,

    CONSTRAINT FK_CODE_SOLUTION
        FOREIGN KEY (SOLUTION_ID)
        REFERENCES PROBLEM_SOLUTIONS(SOLUTION_ID)
        ON DELETE CASCADE
);

